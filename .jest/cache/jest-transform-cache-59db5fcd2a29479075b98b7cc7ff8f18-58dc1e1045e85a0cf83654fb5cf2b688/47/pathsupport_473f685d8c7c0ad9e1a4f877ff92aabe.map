{"version":3,"sources":["path-support.js"],"names":["androidScaleSuffix","getAndroidAssetSuffix","scale","toString","Error","drawableFileTypes","Set","getAndroidResourceFolderName","asset","has","type","suffix","JSON","stringify","getAndroidResourceIdentifier","getBasePath","name","toLowerCase","replace","basePath","httpServerLocation","startsWith","substr","module","exports"],"mappings":"AAUA;;AAIA,IAAMA,kBAAkB,GAAG;AACzB,UAAQ,MADiB;AAEzB,OAAK,MAFoB;AAGzB,SAAO,MAHkB;AAIzB,OAAK,OAJoB;AAKzB,OAAK,QALoB;AAMzB,OAAK;AANoB,CAA3B;;AAaA,SAASC,qBAAT,CAA+BC,KAA/B,EAAsD;AACpD,MAAIA,KAAK,CAACC,QAAN,MAAoBH,kBAAxB,EAA4C;AAC1C,WAAOA,kBAAkB,CAACE,KAAK,CAACC,QAAN,EAAD,CAAzB;AACD;;AAED,QAAM,IAAIC,KAAJ,CAAU,mBAAmBF,KAAK,CAACC,QAAN,EAA7B,CAAN;AACD;;AAGD,IAAME,iBAAiB,GAAG,IAAIC,GAAJ,CAAQ,CAChC,KADgC,EAEhC,MAFgC,EAGhC,KAHgC,EAIhC,KAJgC,EAKhC,KALgC,EAMhC,MANgC,EAOhC,KAPgC,CAAR,CAA1B;;AAUA,SAASC,4BAAT,CACEC,KADF,EAEEN,KAFF,EAGqC;AACnC,MAAI,CAACG,iBAAiB,CAACI,GAAlB,CAAsBD,KAAK,CAACE,IAA5B,CAAL,EAAwC;AACtC,WAAO,KAAP;AACD;;AACD,MAAMC,MAAM,GAAGV,qBAAqB,CAACC,KAAD,CAApC;;AACA,MAAI,CAACS,MAAL,EAAa;AACX,UAAM,IAAIP,KAAJ,CACJ,gEACEF,KADF,GAEE,WAFF,GAGEU,IAAI,CAACC,SAAL,CAAeL,KAAf,EAAsB,IAAtB,EAA4B,IAA5B,CAHF,GAIE,wBAJF,GAKEI,IAAI,CAACC,SAAL,CAAeb,kBAAf,EAAmC,IAAnC,EAAyC,IAAzC,CANE,CAAN;AAQD;;AACD,SAAO,cAAcW,MAArB;AACD;;AAED,SAASG,4BAAT,CAAsCN,KAAtC,EAAoE;AAClE,SAAO,CAACO,WAAW,CAACP,KAAD,CAAX,GAAqB,GAArB,GAA2BA,KAAK,CAACQ,IAAlC,EACJC,WADI,GAEJC,OAFI,CAEI,KAFJ,EAEW,GAFX,EAGJA,OAHI,CAGI,eAHJ,EAGqB,EAHrB,EAIJA,OAJI,CAII,UAJJ,EAIgB,EAJhB,CAAP;AAKD;;AAED,SAASH,WAAT,CAAqBP,KAArB,EAAmD;AACjD,MAAMW,QAAQ,GAAGX,KAAK,CAACY,kBAAvB;AACA,SAAOD,QAAQ,CAACE,UAAT,CAAoB,GAApB,IAA2BF,QAAQ,CAACG,MAAT,CAAgB,CAAhB,CAA3B,GAAgDH,QAAvD;AACD;;AAEDI,MAAM,CAACC,OAAP,GAAiB;AACfjB,EAAAA,4BAA4B,EAA5BA,4BADe;AAEfO,EAAAA,4BAA4B,EAA5BA,4BAFe;AAGfC,EAAAA,WAAW,EAAXA;AAHe,CAAjB","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * @flow strict\n */\n\n'use strict';\n\nimport type {PackagerAsset} from './registry.js';\n\nconst androidScaleSuffix = {\n  '0.75': 'ldpi',\n  '1': 'mdpi',\n  '1.5': 'hdpi',\n  '2': 'xhdpi',\n  '3': 'xxhdpi',\n  '4': 'xxxhdpi',\n};\n\n/**\n * FIXME: using number to represent discrete scale numbers is fragile in essence because of\n * floating point numbers imprecision.\n */\nfunction getAndroidAssetSuffix(scale: number): string {\n  if (scale.toString() in androidScaleSuffix) {\n    return androidScaleSuffix[scale.toString()];\n  }\n\n  throw new Error('no such scale ' + scale.toString());\n}\n\n// See https://developer.android.com/guide/topics/resources/drawable-resource.html\nconst drawableFileTypes = new Set([\n  'gif',\n  'jpeg',\n  'jpg',\n  'png',\n  'svg',\n  'webp',\n  'xml',\n]);\n\nfunction getAndroidResourceFolderName(\n  asset: PackagerAsset,\n  scale: number,\n): string | $TEMPORARY$string<'raw'> {\n  if (!drawableFileTypes.has(asset.type)) {\n    return 'raw';\n  }\n  const suffix = getAndroidAssetSuffix(scale);\n  if (!suffix) {\n    throw new Error(\n      \"Don't know which android drawable suffix to use for scale: \" +\n        scale +\n        '\\nAsset: ' +\n        JSON.stringify(asset, null, '\\t') +\n        '\\nPossible scales are:' +\n        JSON.stringify(androidScaleSuffix, null, '\\t'),\n    );\n  }\n  return 'drawable-' + suffix;\n}\n\nfunction getAndroidResourceIdentifier(asset: PackagerAsset): string {\n  return (getBasePath(asset) + '/' + asset.name)\n    .toLowerCase()\n    .replace(/\\//g, '_') // Encode folder structure in file name\n    .replace(/([^a-z0-9_])/g, '') // Remove illegal chars\n    .replace(/^assets_/, ''); // Remove \"assets_\" prefix\n}\n\nfunction getBasePath(asset: PackagerAsset): string {\n  const basePath = asset.httpServerLocation;\n  return basePath.startsWith('/') ? basePath.substr(1) : basePath;\n}\n\nmodule.exports = {\n  getAndroidResourceFolderName,\n  getAndroidResourceIdentifier,\n  getBasePath,\n};\n"]}